

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Spherical harmonics &#8212; Napari-stress documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '03_glossary/01_spherical_harmonics/01_spherical_harmonics';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Analyzing spherical harmonics" href="02_analyzing_spherical_harmonics.html" />
    <link rel="prev" title="Spherical harmonics" href="Readme.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Usage</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../01_code_usage/code_usage.html">From code</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../01_code_usage/01_toolboxes/Readme.html">Toolboxes</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../01_code_usage/01_toolboxes/demo_droplet_reconstruction_toolbox_code.html">Droplet reconstruction from code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../01_code_usage/01_toolboxes/demo_anisotropic_stresses.html">Anisotropic stresses</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../01_code_usage/01_toolboxes/demo_analyze_everything.html">Analyze everything</a></li>


</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../01_code_usage/02_example_workflows/Readme.html">Other example workflows</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../01_code_usage/02_example_workflows/demo_fit_ellipsoid_code.html">Ellipsoid fitting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../01_code_usage/02_example_workflows/demo_measure_patch_fitted_curvature.html">Measure patch-fitted curvature</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../01_code_usage/02_example_workflows/demo_surface_reconstruction_code.html">Surface reconstruction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../01_code_usage/02_example_workflows/demo_surface_tracing.html">Trace refining a surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../01_code_usage/02_example_workflows/demo_patch_fitting_reconstruction.html">Patch smoothing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../01_code_usage/02_example_workflows/demo_spherical_harmonics_code.html">Spherical harmonics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../01_code_usage/02_example_workflows/demo_timelapse_processing.html">Timelapse processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../01_code_usage/02_example_workflows/demo_measure_intensity_on_surface.html">Measureing intensity on a surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../01_code_usage/02_example_workflows/demo_measure_intensity_on_vectors.html">Measureing intensity on vectors and surfaces</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../02_interactive_usage/interactive_usage.html">Interactive usage</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../02_interactive_usage/01_toolboxes/Readme.html">Toolboxes</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../02_interactive_usage/01_toolboxes/demo_droplet_reconstruction_toolbox.html">Droplet reconstruction toolbox</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../02_interactive_usage/01_toolboxes/demo_stress_toolbox_interactive.html">Comprehensive stress analysis</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../02_interactive_usage/02_example_workflows/Readme.html">Other example workflows</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../02_interactive_usage/02_example_workflows/demo_fit_ellipsoid_interactive.html">Ellipse fitting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../02_interactive_usage/02_example_workflows/demo_surface_reconstruction_interactive.html">Surface reconstruction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../02_interactive_usage/02_example_workflows/demo_spherical_harmonics_interactive.html">Spherical harmonics expansion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../02_interactive_usage/02_example_workflows/demo_measure_curvature.html">Measure curvature</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../02_interactive_usage/02_example_workflows/visualize_measurements_in_viewer.html">Visualize measurements</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Glossary</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="Readme.html">Spherical harmonics</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Spherical harmonics</a></li>
<li class="toctree-l2"><a class="reference internal" href="02_analyzing_spherical_harmonics.html">Analyzing spherical harmonics</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">FAQ</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../04_FAQ/Installation.html">Installation issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../04_FAQ/Acknowledgement_and_citation.html">Acknowledgement &amp; Citation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../04_FAQ/Validation.html">Validation</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../04_FAQ/validation/validation_stress_paper.html">Napari-stress validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../04_FAQ/validation/analyze_validation.html">Validation</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../04_FAQ/validation/create_validation_data.html">Create synthetic validation data</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../05_API/api.html"><cite>napari_stress</cite></a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../05_API/measurements.html"><cite>Measurements module</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../05_API/vectors.html"><cite>Vectors module</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../05_API/approximation.html"><cite>Approximation module</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../05_API/reconstruction.html"><cite>Reconstruction module</cite></a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/03_glossary/01_spherical_harmonics/01_spherical_harmonics.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Spherical harmonics</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#polar-coordinates">Polar coordinates</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Spherical harmonics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spherical-harmonics-expansion">Spherical harmonics expansion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spherical-harmonics-shape-description">Spherical harmonics shape description</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#i-calculate-point-radius-as-function-of-latitude-and-longitude">i ) Calculate point radius as function of latitude and longitude</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ii-calculate-cartesian-coordinate-as-a-function-of-latitude-and-longitude">ii ) Calculate cartesian coordinate as a function of latitude and longitude</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iii-calculate-other-coordinates-as-a-function-of-latitude-and-longitude">iii ) Calculate other coordinates as a function of latitude and longitude</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="spherical-harmonics">
<span id="glossary-spherical-harmonics-mathematical-basics"></span><span id="spherical-harmonics-mathematical-basics"></span><h1>Spherical harmonics<a class="headerlink" href="#spherical-harmonics" title="Permalink to this headline">#</a></h1>
<p>In this notebook you will learn about <a class="reference external" href="https://en.wikipedia.org/wiki/Spherical_harmonics">spherical harmonics</a>, how they work and how they can be used with a spherical harmonics expansion to represent biological data.</p>
<section id="polar-coordinates">
<h2>Polar coordinates<a class="headerlink" href="#polar-coordinates" title="Permalink to this headline">#</a></h2>
<p>Generally speaking, spherical harmonics provide a mathematical framework to tackle problems that are best described in polar coordinates. When we use polar coordinates, we describe the location of a point in space in terms of</p>
<ul class="simple">
<li><p>latitude <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p>longitude <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
<li><p>radius <span class="math notranslate nohighlight">\(r\)</span></p></li>
</ul>
<p>….rather than x, y and z, which we refer to as <em>cartesian coordinates</em>. There are many instances of problems that are better described in polar coordinates:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Atomic_orbital">Quantum mechanics</a>: The probability of encountering an electron at a particular position in the orbit around the nucleus of atoms follows a particular distribution which can be described well with spherical harmonics.</p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Earth%27s_magnetic_field">Earth magnetism</a>: Magnetic forces on the surface of the earth can easily be described with respect to latitude and longtitude</p></li>
<li><p>The shape of cell nuclei: This is what we will be doing with napari-stress :)</p></li>
</ul>
</section>
<section id="id1">
<h2>Spherical harmonics<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h2>
<p>What the above listed probels from quantum mechanics and magentism have in common, is that the problems that are described have a periodical nature: For instance, if youwere to circumvent the surface of the earth along a line of constant longitude, you would experience a periodical rise and fall of magnetic field strength as you get closer and further to the poles. Naturally, such phenomena are well described by trigonometric functions (<em>cosine</em> &amp; <em>sine</em>). Spherical harmonics generalize these functions to describe phenomena on the surface of spheres.</p>
<p>Mathematically, spherical harmonic functions <span class="math notranslate nohighlight">\(Y_l^m\)</span> of degree <span class="math notranslate nohighlight">\(l\)</span> and order <span class="math notranslate nohighlight">\(m\)</span> follow the following formulation:</p>
<p><span class="math notranslate nohighlight">\(Y_l^m(\theta, \phi) = N e^{im\phi} P_l^m(\theta, \phi)\)</span></p>
<p>where <span class="math notranslate nohighlight">\(N\)</span> and <span class="math notranslate nohighlight">\(P_l^m\)</span> are a problem-specific normalization constant and the <a class="reference external" href="https://en.wikipedia.org/wiki/Associated_Legendre_polynomials">associated Legendre polynomials</a>. You may notice, that the factor <span class="math notranslate nohighlight">\(e^{im\phi}\)</span> introduces an imaginary and a real part of this function:</p>
<p><span class="math notranslate nohighlight">\(
Im(Y_l^m) = \sin(\left|m\right| \phi) \cdot P_l^{\left|m\right|}\\
Re(Y_l^m) = \cos(m \phi) \cdot P_l^{m}
\)</span></p>
</section>
<section id="spherical-harmonics-expansion">
<span id="spherical-harmonics-mathematical-basics-degree"></span><h2>Spherical harmonics expansion<a class="headerlink" href="#spherical-harmonics-expansion" title="Permalink to this headline">#</a></h2>
<p>This framework can be used to represent any function <span class="math notranslate nohighlight">\(f(\theta, \phi)\)</span> on the surface of a sphere as a linear superposition of <span class="math notranslate nohighlight">\(Y_l^m\)</span> of different degree <span class="math notranslate nohighlight">\(l\)</span> and order <span class="math notranslate nohighlight">\(m\)</span>:</p>
<p><span class="math notranslate nohighlight">\(f(\theta, \phi) = \sum_{l=0}^{\inf} \sum_{m=-l}^{l} f_l^m Y_l^m(\theta, \phi)\)</span></p>
<p>where <span class="math notranslate nohighlight">\(f_l^m\)</span> are the coefficients that determine how much each degree and order of the spherical harmonics functions <span class="math notranslate nohighlight">\(Y_l^m(\theta, \phi)\)</span> contribute to the sum. In other words, you can use this superposition to approximate the value of any function that depends on latitude and longitude as inputs. It is important to understand that this definition is assuming spheres of radius <span class="math notranslate nohighlight">\(r=1\)</span> - the result of <span class="math notranslate nohighlight">\(f(\theta, \phi)\)</span> can represent any property on the surface of this sphere. The Wikipedia page features a nice <a class="reference external" href="https://en.wikipedia.org/wiki/Spherical_harmonics#/media/File:Rotating_spherical_harmonics.gif">visualization</a> for the contributions of spherical harmonics of specific degree and order on the surface of a sphere.</p>
<p>Using this framework has several desirable characteristics:</p>
<ul class="simple">
<li><p>Any real function on the surface of a sphere can be approximated with a spherical harmonics expansion</p></li>
<li><p>An obtained spherical harmonics expansion can be described entirely by the coefficients <span class="math notranslate nohighlight">\(f_l^m\)</span></p></li>
</ul>
</section>
<section id="spherical-harmonics-shape-description">
<h2>Spherical harmonics shape description<a class="headerlink" href="#spherical-harmonics-shape-description" title="Permalink to this headline">#</a></h2>
<p>In the context of napari-stress, a spherical harmonics expansion is used to obtain spherical harmonics coefficients <span class="math notranslate nohighlight">\(f_l^m\)</span> that describe the position of a vertex on the surface of an object (e.g., an oil droplet):</p>
<p><img alt="" src="../../_images/open_sample_droplet1.png" /></p>
<p>In this case, the property that should be described in terms of latitude and longitude, is the <em>position</em> of the vertices on the surface. In other words, we would like to obtain a relation such as follows:</p>
<p><span class="math notranslate nohighlight">\(f(\vec{x}_i) = \sum_{l=0}^{\inf} \sum_{m=-l}^{l} f_l^m Y_l^m(\theta_i, \phi_i)\)</span></p>
<p>There are different ways of achieving this:</p>
<section id="i-calculate-point-radius-as-function-of-latitude-and-longitude">
<h3>i ) Calculate point radius as function of latitude and longitude<a class="headerlink" href="#i-calculate-point-radius-as-function-of-latitude-and-longitude" title="Permalink to this headline">#</a></h3>
<p>In the simplest approach, we can convert all points <span class="math notranslate nohighlight">\(\vec{x}_i\)</span> on a surface to polar coordinates with respect to their center of mass:</p>
<p><span class="math notranslate nohighlight">\(\vec{x}_i = [\theta_i, \phi_i, r_i]\)</span></p>
<p>We can then use a sperhical harmonics expansion to describe the radius <span class="math notranslate nohighlight">\(r\)</span> as a function of latitude of longitude (<span class="math notranslate nohighlight">\(r = r(\theta, \phi)\)</span>:</p>
<p><span class="math notranslate nohighlight">\(
r(\theta, \phi) = \sum_{l=0}^{\inf} \sum_{m=-l}^{l} f_l^m Y_l^m(\theta_i, \phi_i)
\)</span></p>
<p>The expression for the ccordinate of a point <span class="math notranslate nohighlight">\(\vec{x}_i\)</span> then becomes:</p>
<p><span class="math notranslate nohighlight">\(
\vec{x}_i = [\theta_i, \phi_i, r(\theta, \phi)]
\)</span></p>
<p>This works well for point clouds that retain sphere-like geometries , but may lead to an erroneous expansion if the to-be-approximated pointcloud is highly curved and non-convex.</p>
</section>
<section id="ii-calculate-cartesian-coordinate-as-a-function-of-latitude-and-longitude">
<h3>ii ) Calculate cartesian coordinate as a function of latitude and longitude<a class="headerlink" href="#ii-calculate-cartesian-coordinate-as-a-function-of-latitude-and-longitude" title="Permalink to this headline">#</a></h3>
<p>To address the problem of approximating highly non-sphere-like pointclouds, it is of advantage to approximate the different components of a point coordinate separately. This can be done by not only expressing the radius of a point as a function of latitude and longitude, but each of its cartesian components:</p>
<p><span class="math notranslate nohighlight">\(\vec{x}_i = [x_i, y_i, z_i]\)</span></p>
<p>Each of these can be approximated by a separate spherical harmonics expansion with a separate set of spherical harmonics coefficients <span class="math notranslate nohighlight">\(f_l^m\)</span>:</p>
<p><span class="math notranslate nohighlight">\(
x(\theta, \phi) = \sum_{l=0}^{\inf} \sum_{m=-l}^{l} f_{l, x}^m Y_l^m(\theta_i, \phi_i)\\
y(\theta, \phi) = \sum_{l=0}^{\inf} \sum_{m=-l}^{l} f_{l, y}^m Y_l^m(\theta_i, \phi_i)\\
z(\theta, \phi) = \sum_{l=0}^{\inf} \sum_{m=-l}^{l} f_{l, z}^m Y_l^m(\theta_i, \phi_i)
\)</span></p>
<p>The position of a point <span class="math notranslate nohighlight">\(\vec{x}_i\)</span> can then be described by the following expression</p>
<p><span class="math notranslate nohighlight">\(\vec{x}_i = [x(\theta_i, \phi_i), y(\theta_i, \phi_i), z(\theta_i, \phi_i)]\)</span></p>
<p>where the coefficients <span class="math notranslate nohighlight">\(f_x\)</span>, <span class="math notranslate nohighlight">\(f_y\)</span>, <span class="math notranslate nohighlight">\(f_z\)</span> refer to the spherical harmonics coefficients of the three distinct expansions.</p>
</section>
<section id="iii-calculate-other-coordinates-as-a-function-of-latitude-and-longitude">
<h3>iii ) Calculate other coordinates as a function of latitude and longitude<a class="headerlink" href="#iii-calculate-other-coordinates-as-a-function-of-latitude-and-longitude" title="Permalink to this headline">#</a></h3>
<p>In principle, the previously described coordinate parametrizations can be expanded to any set of coordinate parametrization. Other coordinate formulations that can be used for this sort of coordinate parametrization are <a class="reference external" href="https://en.wikipedia.org/wiki/Cylindrical_coordinate_system">cylindrical coordinates </a> or <a class="reference external" href="https://en.wikipedia.org/wiki/Ellipsoidal_coordinates">ellipsoidal coordinates</a>.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./03_glossary/01_spherical_harmonics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="Readme.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Spherical harmonics</p>
      </div>
    </a>
    <a class="right-next"
       href="02_analyzing_spherical_harmonics.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Analyzing spherical harmonics</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#polar-coordinates">Polar coordinates</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Spherical harmonics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spherical-harmonics-expansion">Spherical harmonics expansion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spherical-harmonics-shape-description">Spherical harmonics shape description</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#i-calculate-point-radius-as-function-of-latitude-and-longitude">i ) Calculate point radius as function of latitude and longitude</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ii-calculate-cartesian-coordinate-as-a-function-of-latitude-and-longitude">ii ) Calculate cartesian coordinate as a function of latitude and longitude</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iii-calculate-other-coordinates-as-a-function-of-latitude-and-longitude">iii ) Calculate other coordinates as a function of latitude and longitude</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Johannes Soltwedel
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>