
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>3.1. Spherical harmonics &#8212; Napari-stress documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="3.2. Analyzing spherical harmonics" href="02_analyzing_spherical_harmonics.html" />
    <link rel="prev" title="3. Spherical harmonics" href="Readme.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Napari-stress documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Functions
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01_surface_reconstruction/Readme.html">
   1. Surface reconstruction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_surface_reconstruction/01_demo_surface_reconstruction_code.html">
     1.1. Usage from code
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_surface_reconstruction/02_demo_surface_reconstruction_interactive.html">
     1.2. Interactive usage
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02_surface_tracing/Readme.html">
   2. Trace-refinement
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_surface_tracing/01_demo_surface_tracing.html">
     2.1. Usage from code
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="Readme.html">
   3. Spherical harmonics
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     3.1. Spherical harmonics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_analyzing_spherical_harmonics.html">
     3.2. Analyzing spherical harmonics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_demo_spherical_harmonics_code.html">
     3.3. Usage from code
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04_demo_spherical_harmonics_interactive.html">
     3.4. Interactive usage
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../04_fit_ellipsoid/Readme.html">
   4. Ellipsoid-fiting
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../04_fit_ellipsoid/01_demo_fit_ellipsoid_code.html">
     4.1. Usage from code
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04_fit_ellipsoid/02_demo_fit_ellipsoid_interactive.html">
     4.2. Interactive usage
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../05_measure_curvature/Readme.html">
   5. Measure curvature and stress
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../05_measure_curvature/01_demo_analyze_spherical_harmonics.html">
     5.1. Usage from code
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05_measure_curvature/02_demo_measure_curvature.html">
     5.2. Interactive usage
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Toolboxes
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../02_toolboxes/01_droplet_reconstruction/Readme.html">
   6. Droplet reconstruction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../02_toolboxes/01_droplet_reconstruction/demo_droplet_reconstruction_toolbox.html">
     6.1. Droplet reconstruction toolbox
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../02_toolboxes/02_measure_stress/Readme.html">
   7. Stress measurement
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../02_toolboxes/02_measure_stress/02_demo_stress_toolbox.html">
     7.1. Usage from code
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../02_toolboxes/02_measure_stress/03_demo_stress_toolbox_interactive.html">
     7.2. Interactive usage
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../02_toolboxes/03_analyze_everything/demo_analyze_everything.html">
   8. Analyze everything
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Example workflows
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../03_workflows/Image_to_surface.html">
   11. From intensity image to surface
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../03_workflows/Surface_to_curvature.html">
   12. From surface data to curvatures
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Utility
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../04_utility/01_demo_visualize_features.html">
   13. Visualize measurements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../04_utility/02_demo_timelapse_processing.html">
   14. Decorator for time-lapse processing
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/glossary/03_spherical_harmonics/01_spherical_harmonics.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#polar-coordinates">
   3.1.1. Polar coordinates
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   3.1.2. Spherical harmonics
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#spherical-harmonics-expansion">
   3.1.3. Spherical harmonics expansion
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#spherical-harmonics-shape-description">
   3.1.4. Spherical harmonics shape description
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#i-calculate-point-radius-as-function-of-latitude-and-longitude">
     3.1.4.1. i ) Calculate point radius as function of latitude and longitude
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ii-calculate-cartesian-coordinate-as-a-function-of-latitude-and-longitude">
     3.1.4.2. ii ) Calculate cartesian coordinate as a function of latitude and longitude
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iii-calculate-other-coordinates-as-a-function-of-latitude-and-longitude">
     3.1.4.3. iii ) Calculate other coordinates as a function of latitude and longitude
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Spherical harmonics</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#polar-coordinates">
   3.1.1. Polar coordinates
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   3.1.2. Spherical harmonics
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#spherical-harmonics-expansion">
   3.1.3. Spherical harmonics expansion
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#spherical-harmonics-shape-description">
   3.1.4. Spherical harmonics shape description
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#i-calculate-point-radius-as-function-of-latitude-and-longitude">
     3.1.4.1. i ) Calculate point radius as function of latitude and longitude
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ii-calculate-cartesian-coordinate-as-a-function-of-latitude-and-longitude">
     3.1.4.2. ii ) Calculate cartesian coordinate as a function of latitude and longitude
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iii-calculate-other-coordinates-as-a-function-of-latitude-and-longitude">
     3.1.4.3. iii ) Calculate other coordinates as a function of latitude and longitude
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="spherical-harmonics">
<span id="glossary-spherical-harmonics-mathematical-basics"></span><span id="spherical-harmonics-mathematical-basics"></span><h1><span class="section-number">3.1. </span>Spherical harmonics<a class="headerlink" href="#spherical-harmonics" title="Permalink to this headline">#</a></h1>
<p>In this notebook you will learn about <a class="reference external" href="https://en.wikipedia.org/wiki/Spherical_harmonics">spherical harmonics</a>, how they work and how they can be used with a spherical harmonics expansion to represent biological data.</p>
<section id="polar-coordinates">
<h2><span class="section-number">3.1.1. </span>Polar coordinates<a class="headerlink" href="#polar-coordinates" title="Permalink to this headline">#</a></h2>
<p>Generally speaking, spherical harmonics provide a mathematical framework to tackle problems that are best described in polar coordinates. When we use polar coordinates, we describe the location of a point in space in terms of</p>
<ul class="simple">
<li><p>latitude <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p>longitude <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
<li><p>radius <span class="math notranslate nohighlight">\(r\)</span></p></li>
</ul>
<p>….rather than x, y and z, which we refer to as <em>cartesian coordinates</em>. There are many instances of problems that are better described in polar coordinates:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Atomic_orbital">Quantum mechanics</a>: The probability of encountering an electron at a particular position in the orbit around the nucleus of atoms follows a particular distribution which can be described well with spherical harmonics.</p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Earth%27s_magnetic_field">Earth magnetism</a>: Magnetic forces on the surface of the earth can easily be described with respect to latitude and longtitude</p></li>
<li><p>The shape of cell nuclei: This is what we will be doing with napari-stress :)</p></li>
</ul>
</section>
<section id="id1">
<h2><span class="section-number">3.1.2. </span>Spherical harmonics<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h2>
<p>What the above listed probels from quantum mechanics and magentism have in common, is that the problems that are described have a periodical nature: For instance, if youwere to circumvent the surface of the earth along a line of constant longitude, you would experience a periodical rise and fall of magnetic field strength as you get closer and further to the poles. Naturally, such phenomena are well described by trigonometric functions (<em>cosine</em> &amp; <em>sine</em>). Spherical harmonics generalize these functions to describe phenomena on the surface of spheres.</p>
<p>Mathematically, spherical harmonic functions <span class="math notranslate nohighlight">\(Y_l^m\)</span> of degree <span class="math notranslate nohighlight">\(l\)</span> and order <span class="math notranslate nohighlight">\(m\)</span> follow the following formulation:</p>
<p><span class="math notranslate nohighlight">\(Y_l^m(\theta, \phi) = N e^{im\phi} P_l^m(\theta, \phi)\)</span></p>
<p>where <span class="math notranslate nohighlight">\(N\)</span> and <span class="math notranslate nohighlight">\(P_l^m\)</span> are a problem-specific normalization constant and the <a class="reference external" href="https://en.wikipedia.org/wiki/Associated_Legendre_polynomials">associated Legendre polynomials</a>. You may notice, that the factor <span class="math notranslate nohighlight">\(e^{im\phi}\)</span> introduces an imaginary and a real part of this function:</p>
<p><span class="math notranslate nohighlight">\(
Im(Y_l^m) = \sin(\left|m\right| \phi) \cdot P_l^{\left|m\right|}\\
Re(Y_l^m) = \cos(m \phi) \cdot P_l^{m}
\)</span></p>
</section>
<section id="spherical-harmonics-expansion">
<span id="spherical-harmonics-mathematical-basics-degree"></span><h2><span class="section-number">3.1.3. </span>Spherical harmonics expansion<a class="headerlink" href="#spherical-harmonics-expansion" title="Permalink to this headline">#</a></h2>
<p>This framework can be used to represent any function <span class="math notranslate nohighlight">\(f(\theta, \phi)\)</span> on the surface of a sphere as a linear superposition of <span class="math notranslate nohighlight">\(Y_l^m\)</span> of different degree <span class="math notranslate nohighlight">\(l\)</span> and order <span class="math notranslate nohighlight">\(m\)</span>:</p>
<p><span class="math notranslate nohighlight">\(f(\theta, \phi) = \sum_{l=0}^{\inf} \sum_{m=-l}^{l} f_l^m Y_l^m(\theta, \phi)\)</span></p>
<p>where <span class="math notranslate nohighlight">\(f_l^m\)</span> are the coefficients that determine how much each degree and order of the spherical harmonics functions <span class="math notranslate nohighlight">\(Y_l^m(\theta, \phi)\)</span> contribute to the sum. In other words, you can use this superposition to approximate the value of any function that depends on latitude and longitude as inputs. It is important to understand that this definition is assuming spheres of radius <span class="math notranslate nohighlight">\(r=1\)</span> - the result of <span class="math notranslate nohighlight">\(f(\theta, \phi)\)</span> can represent any property on the surface of this sphere. The Wikipedia page features a nice <a class="reference external" href="https://en.wikipedia.org/wiki/Spherical_harmonics#/media/File:Rotating_spherical_harmonics.gif">visualization</a> for the contributions of spherical harmonics of specific degree and order on the surface of a sphere.</p>
<p>Using this framework has several desirable characteristics:</p>
<ul class="simple">
<li><p>Any real function on the surface of a sphere can be approximated with a spherical harmonics expansion</p></li>
<li><p>An obtained spherical harmonics expansion can be described entirely by the coefficients <span class="math notranslate nohighlight">\(f_l^m\)</span></p></li>
</ul>
</section>
<section id="spherical-harmonics-shape-description">
<h2><span class="section-number">3.1.4. </span>Spherical harmonics shape description<a class="headerlink" href="#spherical-harmonics-shape-description" title="Permalink to this headline">#</a></h2>
<p>In the context of napari-stress, a spherical harmonics expansion is used to obtain spherical harmonics coefficients <span class="math notranslate nohighlight">\(f_l^m\)</span> that describe the position of a vertex on the surface of an object (e.g., an oil droplet):</p>
<p><img alt="" src="../../_images/open_sample_droplet1.png" /></p>
<p>In this case, the property that should be described in terms of latitude and longitude, is the <em>position</em> of the vertices on the surface. In other words, we would like to obtain a relation such as follows:</p>
<p><span class="math notranslate nohighlight">\(f(\vec{x}_i) = \sum_{l=0}^{\inf} \sum_{m=-l}^{l} f_l^m Y_l^m(\theta_i, \phi_i)\)</span></p>
<p>There are different ways of achieving this:</p>
<section id="i-calculate-point-radius-as-function-of-latitude-and-longitude">
<h3><span class="section-number">3.1.4.1. </span>i ) Calculate point radius as function of latitude and longitude<a class="headerlink" href="#i-calculate-point-radius-as-function-of-latitude-and-longitude" title="Permalink to this headline">#</a></h3>
<p>In the simplest approach, we can convert all points <span class="math notranslate nohighlight">\(\vec{x}_i\)</span> on a surface to polar coordinates with respect to their center of mass:</p>
<p><span class="math notranslate nohighlight">\(\vec{x}_i = [\theta_i, \phi_i, r_i]\)</span></p>
<p>We can then use a sperhical harmonics expansion to describe the radius <span class="math notranslate nohighlight">\(r\)</span> as a function of latitude of longitude (<span class="math notranslate nohighlight">\(r = r(\theta, \phi)\)</span>:</p>
<p><span class="math notranslate nohighlight">\(
r(\theta, \phi) = \sum_{l=0}^{\inf} \sum_{m=-l}^{l} f_l^m Y_l^m(\theta_i, \phi_i)
\)</span></p>
<p>The expression for the ccordinate of a point <span class="math notranslate nohighlight">\(\vec{x}_i\)</span> then becomes:</p>
<p><span class="math notranslate nohighlight">\(
\vec{x}_i = [\theta_i, \phi_i, r(\theta, \phi)]
\)</span></p>
<p>This works well for point clouds that retain sphere-like geometries , but may lead to an erroneous expansion if the to-be-approximated pointcloud is highly curved and non-convex.</p>
</section>
<section id="ii-calculate-cartesian-coordinate-as-a-function-of-latitude-and-longitude">
<h3><span class="section-number">3.1.4.2. </span>ii ) Calculate cartesian coordinate as a function of latitude and longitude<a class="headerlink" href="#ii-calculate-cartesian-coordinate-as-a-function-of-latitude-and-longitude" title="Permalink to this headline">#</a></h3>
<p>To address the problem of approximating highly non-sphere-like pointclouds, it is of advantage to approximate the different components of a point coordinate separately. This can be done by not only expressing the radius of a point as a function of latitude and longitude, but each of its cartesian components:</p>
<p><span class="math notranslate nohighlight">\(\vec{x}_i = [x_i, y_i, z_i]\)</span></p>
<p>Each of these can be approximated by a separate spherical harmonics expansion with a separate set of spherical harmonics coefficients <span class="math notranslate nohighlight">\(f_l^m\)</span>:</p>
<p><span class="math notranslate nohighlight">\(
x(\theta, \phi) = \sum_{l=0}^{\inf} \sum_{m=-l}^{l} f_{l, x}^m Y_l^m(\theta_i, \phi_i)\\
y(\theta, \phi) = \sum_{l=0}^{\inf} \sum_{m=-l}^{l} f_{l, y}^m Y_l^m(\theta_i, \phi_i)\\
z(\theta, \phi) = \sum_{l=0}^{\inf} \sum_{m=-l}^{l} f_{l, z}^m Y_l^m(\theta_i, \phi_i)
\)</span></p>
<p>The position of a point <span class="math notranslate nohighlight">\(\vec{x}_i\)</span> can then be described by the following expression</p>
<p><span class="math notranslate nohighlight">\(\vec{x}_i = [x(\theta_i, \phi_i), y(\theta_i, \phi_i), z(\theta_i, \phi_i)]\)</span></p>
<p>where the coefficients <span class="math notranslate nohighlight">\(f_x\)</span>, <span class="math notranslate nohighlight">\(f_y\)</span>, <span class="math notranslate nohighlight">\(f_z\)</span> refer to the spherical harmonics coefficients of the three distinct expansions.</p>
</section>
<section id="iii-calculate-other-coordinates-as-a-function-of-latitude-and-longitude">
<h3><span class="section-number">3.1.4.3. </span>iii ) Calculate other coordinates as a function of latitude and longitude<a class="headerlink" href="#iii-calculate-other-coordinates-as-a-function-of-latitude-and-longitude" title="Permalink to this headline">#</a></h3>
<p>In principle, the previously described coordinate parametrizations can be expanded to any set of coordinate parametrization. Other coordinate formulations that can be used for this sort of coordinate parametrization are <a class="reference external" href="https://en.wikipedia.org/wiki/Cylindrical_coordinate_system">cylindrical coordinates </a> or <a class="reference external" href="https://en.wikipedia.org/wiki/Ellipsoidal_coordinates">ellipsoidal coordinates</a>.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./glossary/03_spherical_harmonics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="Readme.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">3. </span>Spherical harmonics</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="02_analyzing_spherical_harmonics.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">3.2. </span>Analyzing spherical harmonics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Johannes Müller<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>